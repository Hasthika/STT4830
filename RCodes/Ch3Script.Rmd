---
title: "Diagnostics and Remedial Measures in $R$"
author: ""
date: ""
output: 
  html_document:
    number_sections: true
---

```{r setup, include=FALSE, comment=NA, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Read data from an URL {-}

```{r comment=NA, warning=FALSE, message=FALSE}
toluca <- read.table("http://users.stat.ufl.edu/~rrandles/sta4210/Rclassnotes/data/textdatasets/KutnerData/Chapter%20%201%20Data%20Sets/CH01TA01.txt", sep ="" , header = FALSE)


#Look at the first 6 entries
head(toluca)
```


# Rename columns {-}

```{r comment=NA, warning=FALSE, message=FALSE}
colnames(toluca) <- c("lotSize", "hours")

#Look at the first 6 entries
head(toluca)
```

# Convert your data into a `dataframe`

```{r comment=NA, warning=FALSE, message=FALSE}
tolucaDF <- data.frame(toluca)
head(tolucaDF)
```

# Diagnostic Plots for Predictor Variable-Toluca Company Example

## Dot plot 

The dot plot for the lot sizes in the Toluca Company example.

```{r comment=NA, warning=FALSE, message=FALSE}
library(ggplot2)
ggplot(data = tolucaDF, aes(x = lotSize)) + geom_dotplot(color = "blue", fill = "orchid4", dotsize = .5) + theme_bw()
```

## Sequence plot

The Sequence plot for the lot sizes in the Toluca Company example.

not enough data...

## Stem-and-leaf plot

Stem-and-leaf plot of the lot sizes for the Toluca Company example.  By displaying the last digits, this plot also indicates here that all lot sizes in the Toluca Company example were multiples of 10. 

```{r comment=NA, warning=FALSE, message=FALSE}
stem(tolucaDF$lotSize, scale = 3)
```
## Box plot

Box plot of the lot sizes for the Toluca Company example.  

```{r comment=NA, warning=FALSE, message=FALSE}
ggplot(data = tolucaDF, aes(x = lotSize)) + geom_boxplot(color = "steelblue", fill = "orchid4") + theme_bw()
```

# Diagnostics for Residuals (Section 3.3 in the textbook)

## Create the LS model

```{r comment=NA, warning=FALSE, message=FALSE}
# Recall from ch1
toluca_LS_model <- lm(hours ~ lotSize, data = toluca)
summary(toluca_LS_model)
```

## Plot of residuals against predictor variable

```{r comment=NA, warning=FALSE, message=FALSE}
library(ggplot2)
ggplot(toluca_LS_model, aes(x = lotSize, y = .resid)) + geom_point(color = "blue", dotsize = .5) + theme_bw()
```

## Plot of residuals against fitted values.

```{r comment=NA, warning=FALSE, message=FALSE}
ggplot(toluca_LS_model, aes(x = .fitted, y = .resid)) + geom_point(color = "blue", dotsize = .5) + theme_bw()
```


## Box plot of residuals

```{r}
ggplot(toluca_LS_model, aes(x = .resid)) + geom_boxplot(color = "steelblue", fill = "orchid4") + theme_bw()
```

## Normal probability plot of residuals.

```{r}
ggplot(toluca_LS_model, aes(sample = .resid)) + geom_qq(color = "blue", dotsize = .5) + geom_qq_line()+ theme_bw() 
```

